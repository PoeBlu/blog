<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Downtime Last Night; Coping with outages on a shoestring budget</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://blog.jasonantman.com/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://blog.jasonantman.com/theme/css/pygments.css" rel="stylesheet">
        <link href="http://blog.jasonantman.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/forkongithub.min.css" type="text/css" />

        <link href="http://blog.jasonantman.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog ATOM Feed"/>
        <link href="http://blog.jasonantman.com/feeds/all.rss.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog RSS Feed"/>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2718127-2', 'jasonantman.com');
  ga('send', 'pageview');

</script>
</head>
<body>
<span id="forkongithub"><a href="https://github.com/jantman/blog">Fork me on GitHub</a></span><nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.jasonantman.com" class="navbar-brand">Jason Antman's Blog</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://blog.jasonantman.com/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ideas-and-rants/index.html">Ideas and rants</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/miscellaneous/index.html">Miscellaneous</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/monitoring/index.html">Monitoring</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ops/index.html">Ops</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.jasonantman.com/categories/projects/index.html">Projects</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/puppet/index.html">Puppet</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/tech-howtos/index.html">Tech howtos</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.jasonantman.com/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.jasonantman.com/2011/01/downtime-last-night-coping-with-outages-on-a-shoestring-budget/"
                       rel="bookmark"
                       title="Permalink to Downtime Last Night; Coping with outages on a shoestring budget">
                        Downtime Last Night; Coping with outages on a shoestring&nbsp;budget
                    </a>
                </h1>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="j_antman">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Mon 10 January 2011
    </span>



<span class="label label-default">Tags</span>
	<a href="http://blog.jasonantman.com/tags/disaster-recovery/index.html">disaster recovery</a>
        /
	<a href="http://blog.jasonantman.com/tags/downtime/index.html">downtime</a>
        /
	<a href="http://blog.jasonantman.com/tags/failover/index.html">failover</a>
        /
	<a href="http://blog.jasonantman.com/tags/redundancy/index.html">redundancy</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Anyone who tried to visit any of my sites last night, or send me email,
probably noticed that I dropped off the face of the earth. I take my
uptime pretty seriously - even with virtually no budget, about 10
minutes of <span class="caps">UPS</span> time, and everything hosted out of my basement. I&#8217;ve only
had about a <a href="/2010/03/downtime-past-few-days-coping-with-storms/">6-hour block of
downtime</a> in the
past 21 months, aside from that nothing externally visible except a few
sub-3-minute hiccups. And the 6 hours was due to a major power outage
that quickly overwhelmed my <span class="caps">UPS</span>. Without a generator, I can&#8217;t really
blame anyone for that. Anyway, last night into this morning I had
partial to full outages for about 12 hours. By far the most I&#8217;ve had
since I literally ripped apart my entire infrastructure, moved it from
shelves to a rack, and put it back together on the&nbsp;fly.</p>
<p>I&#8217;d like to apologize to the few people whose web sites or other
services I host out of my house. On one hand, I think those few people
are getting their money&#8217;s worth from their free hosting :) On the other
hand I know how frustrating it can be, especially when you can&#8217;t even
resolve <span class="caps">DNS</span> and my email is down. Rest assured that this situation
deeply bothers me, and I&#8217;m already hard at work on plans to at least
keep people (both the people I do hosting for and their visitors)
informed if something like this should happen in the&nbsp;future.</p>
<p><strong>The&nbsp;Story:</strong></p>
<p>Well, yesterday afternoon as I was at my father&#8217;s house about an hour
away, I started to get a slew of <a href="http://www.nagios.org">Nagios</a>
notification SMSes (well, email to <span class="caps">SMS</span>). They started at 14:22 and
stopped after a few minutes, but since I was driving, I didn&#8217;t check
them. When I got home, I found a scenario I hadn&#8217;t really anticipated -
the <span class="caps">TV</span> worked fine, but I had virtually no connectivity on my cable
Internet line. I got home around 16:22 and had spotty-at-best
connectivity. I could get some <span class="caps">DNS</span> in and out, but it was pretty much
impossible to load a web page on my desktop. I was getting Nagios alerts
out in bursts, and the postfix queue was pretty full. A cursory
inspection showed both routers (mine and Optimum&#8217;s) online with link,
the Modem had link and was blinking away, but I was passing &lt; 100 Kbps
of data. My <span class="caps">DOCSIS</span>-<span class="caps">MIB</span> checks on the cable modem were spitting back all
sorts of bad values. Not good. I checked coax connections, rebooted the
modem and router, and went outside to inspect the aerials and the
splitters on the outside of the house. Nothing visibly wrong, and no
positive change after the reboot. Now the modem wasn&#8217;t showing link at
all, and I couldn&#8217;t even ping its <span class="caps">LAN</span>&nbsp;<span class="caps">IP</span>.</p>
<p>I called Optimum at 17:12 and went through the initial troubleshooting
with the technical support guy. I told him I&#8217;d already power-cycled the
modem, and gave him a rundown of the status lights. He confirmed that
they couldn&#8217;t even see the modem on the <span class="caps">WAN</span> side, and would have to send
a tech out. The big plus to Optimum Business is that, despite it being
after 5 <span class="caps">PM</span> on a Sunday night, I was given an <span class="caps">ETA</span> of 2-4 hours. After
about 15 minutes, I power-cycled the modem again, and was able to get
link. I was seeing some data pushed through the routers, but only about
50Kbps. I called Optimum back, spoke with another tech, and was told
that they couldn&#8217;t even get diagnostics back from the modem, and were
seeing 94% packet loss on ping. Time to wait for the&nbsp;tech.</p>
<p>The field tech arrived at 17:53. Utterly amazing&#8230; about 30 minutes
after I got off the phone with tech support. I don&#8217;t know if they keep
their better techs waiting around for business customers, but this guy -
Jason - was one of the most knowledgeable and experienced that I&#8217;ve ever
met. He poked around the modem a bit, re-did some of the shoddy work
that the original installers left, and then climbed the pole to figure
out what was going on. About half an hour later, he came back with the
bad news. His test scope wouldn&#8217;t even lock on to the 609MHz carrier
used for the cable modem, so there was something definitely wrong, and
it was past the pole in front of the house. He told me they&#8217;d need to
escalate the problem to the outside plant engineers, but since I was a
business customer, I could expect some update or fix in 6-18 hours. He
left around 18:30. Well, I was bummed, but I used the time to get other
stuff done and start planning for at least minimal <span class="caps">DR</span> plans for the&nbsp;future.</p>
<p>According to my off-site Nagios, I at least got some mail out and <span class="caps">SSH</span> in
from 19:55 to 20:44, and then had another total loss of connectivity.
Everything came back around 02:20 today, meaning a full 12 hours of&nbsp;downtime.</p>
<p><strong>Analysis and Future&nbsp;Plans:</strong></p>
<p>Well for the foreseeable future I&#8217;m just working my day job and probably
not doing much (paid) consulting, so purchasing a backup connection is
out of the question - especially since FiOS charges almost twice what
Optimum does for static <span class="caps">IP</span> service. There&#8217;s really no way I could&#8217;ve
prevented this outage, and it turns out that the problem wasn&#8217;t even on
my property, so it&#8217;s not anything I could have fixed myself (or
prevented by convincing Optimum to let me purchase a spare modem to keep
on hand). Once again, for something that isn&#8217;t directly money-making for
me, it&#8217;s not really worth it to try and get hosting as a backup, since
I&#8217;ve got all sorts of complex postfix configurations, <span class="caps">BIND</span> master/slave
replication, etc. Within my budget, I can&#8217;t really say there&#8217;s anything
I could do to solve this problem, or to get even half of my services
back up. My offsite Nagios is behind a dynamic residential cable
connection, so that won&#8217;t really fix any problems&nbsp;either.</p>
<p>My plan for the short-term is to find a static <span class="caps">IP</span> somewhere that I can
run a box behind, add it as a <span class="caps">NS</span> record, and at the minimum setup a
caching Postfix server, a catch-all Apache server with a &#8220;we know about
it, we&#8217;re coming back soon&#8221; page, and hacked <span class="caps">BIND</span> zone files that point
everything at this one box (albeit with a low&nbsp;<span class="caps">TTL</span>).</p>
<p>If anyone out there happens to read this, any comments on how to deal
with a total loss of connectivity on a budget of, say, $15/month above
the cost of my Optimum&nbsp;connection??</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jasonantman'; // required: replace example with your forum shortname
            var disqus_identifier = 'downtime-last-night-coping-with-outages-on-a-shoestring-budget';
            var disqus_url = 'http://blog.jasonantman.com/2011/01/downtime-last-night-coping-with-outages-on-a-shoestring-budget/';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">

                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Recent Posts</h4></li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2014/03/blog-moved-from-self-hosted-wordpress-to-pelican-on-github-pages/">
                                Blog Moved from Self-hosted WordPress to Pelican on GitHub&nbsp;Pages
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2014/03/wordpress-to-pelican-with-disqus-comments/">
                                Wordpress to Pelican with Disqus&nbsp;comments
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2014/02/converting-wordpress-posts-to-pelican-markdown/">
                                Converting WordPress Posts to Pelican&nbsp;MarkDown
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2014/01/planning-migration-from-wordpress-to-static-site/">
                                Planning Migration from WordPress to Static&nbsp;Site
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2013/08/testing-gpg-key-passphrases/">
                                Testing <span class="caps">GPG</span> Key&nbsp;Passphrases
                            </a>
                        </li>


                <li class="list-group-item"><a href="http://blog.jasonantman.com/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                <li class="list-group-item">
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/sun/index.html">
                                sun
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/sysadmin/index.html">
                                sysadmin
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/puppet/index.html">
                                puppet
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/php/index.html">
                                PHP
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/wordpress/index.html">
                                wordpress
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/nagios/index.html">
                                Nagios
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/microsoft/index.html">
                                microsoft
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/android/index.html">
                                android
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/monitoring/index.html">
                                monitoring
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/blog/index.html">
                                blog
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/google/index.html">
                                google
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/linux/index.html">
                                linux
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/syslog/index.html">
                                syslog
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/apache/index.html">
                                apache
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/droid/index.html">
                                droid
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/dns/index.html">
                                dns
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/logging/index.html">
                                logging
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/mediawiki/index.html">
                                mediawiki
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/security/index.html">
                                security
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/firefox/index.html">
                                firefox
                            </a>
                        </span>
                </li>
        </ul>
    </section>
    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item" style="padding: 10px 15px 0px 15px;"><h4><i class="icon-twitter
    icon-large"></i>Twitter <a href="https://twitter.com/j_antman"
    class="twitter-follow-button" data-show-count="false"
    data-dnt="true">Follow @j_antman</a></h4>
<script>!function(d,s,id){var
  js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,
  'script', 'twitter-wjs');</script></li>
    </ul>
    <a class="twitter-timeline" data-dnt="true"
    href="https://twitter.com/j_antman"
    data-chrome="transparent noheader" data-widget-id="429640274453594113">Tweets by @j_antman</a>
    <script>!function(d,s,id){var
    js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </section>
    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item"><h4><i class="icon-github icon-large"></i>GitHub Repos</h4></li>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/jantman">@jantman</a> on GitHub
    </ul>
        <script type="text/javascript">
            $(document).ready(function () {
                if (!window.jXHR) {
                    var jxhr = document.createElement('script');
                    jxhr.type = 'text/javascript';
                    jxhr.src = 'http://blog.jasonantman.com/theme/js/jXHR.js';
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(jxhr, s);
                }

                github.showRepos({
                    user: 'jantman',
                    count: 5,
                    skip_forks: false,
                    target: '#gh_repos'
                });
            });
        </script>
        <script src="http://blog.jasonantman.com/theme/js/github.js" type="text/javascript"></script>
    </section>
</aside>        </div>
    </div>
</div>
<footer>
    <div class="container">
        <hr>
        <p class="pull-right"><i class="icon-arrow-up"></i> <a href="#">Back to top</a></p>


        <p>&copy; 2014 Jason Antman &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a></p>
    </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.jasonantman.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.jasonantman.com/theme/js/respond.min.js"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jasonantman'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>


</body>
</html>