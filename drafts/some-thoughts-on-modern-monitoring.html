<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Some Thoughts on Modern Monitoring</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://blog.jasonantman.com/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://blog.jasonantman.com/theme/css/pygments.css" rel="stylesheet">
        <link href="http://blog.jasonantman.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

    <link rel="stylesheet" href="http://blog.jasonantman.com/theme/css/forkongithub.min.css" type="text/css" />

        <link href="http://blog.jasonantman.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog ATOM Feed"/>
        <link href="http://blog.jasonantman.com/feeds/all.rss.xml" type="application/atom+xml" rel="alternate"
              title="Jason Antman's Blog RSS Feed"/>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2718127-2', 'jasonantman.com');
  ga('send', 'pageview');

</script>
</head>
<body>
<span id="forkongithub"><a href="https://github.com/jantman/blog">Fork me on GitHub</a></span><nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.jasonantman.com" class="navbar-brand">Jason Antman's Blog</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://blog.jasonantman.com/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ideas-and-rants/index.html">Ideas and rants</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/miscellaneous/index.html">Miscellaneous</a>
                        </li>
                        <li class="active">
                            <a href="http://blog.jasonantman.com/categories/monitoring/index.html">Monitoring</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/ops/index.html">Ops</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/projects/index.html">Projects</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/puppet/index.html">Puppet</a>
                        </li>
                        <li >
                            <a href="http://blog.jasonantman.com/categories/tech-howtos/index.html">Tech howtos</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.jasonantman.com/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.jasonantman.com/2015/05/some-thoughts-on-modern-monitoring/"
                       rel="bookmark"
                       title="Permalink to Some Thoughts on Modern Monitoring">
                        Some Thoughts on Modern&nbsp;Monitoring
                    </a>
                </h1>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="j_antman">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Sun 03 May 2015
    </span>



<span class="label label-default">Tags</span>
	<a href="http://blog.jasonantman.com/tags/monitoring/index.html">monitoring</a>
        /
	<a href="http://blog.jasonantman.com/tags/nagios/index.html">nagios</a>
        /
	<a href="http://blog.jasonantman.com/tags/icinga/index.html">icinga</a>
        /
	<a href="http://blog.jasonantman.com/tags/alerting/index.html">alerting</a>
        /
	<a href="http://blog.jasonantman.com/tags/graphing/index.html">graphing</a>
        /
	<a href="http://blog.jasonantman.com/tags/trending/index.html">trending</a>
        /
	<a href="http://blog.jasonantman.com/tags/notifications/index.html">notifications</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Tools like Puppet, Chef and their ilk (Salt, Ansible, etc.) have done wonders for how systems are
managed and configured. But it seems that much of the monitoring space has been left behind. Sure,
services such as NewRelic, AppNeta, Sensu, etc. provide good solutions, or at least parts of solutions,
but it seems that the open source world has fallen far behind the&nbsp;times.</p>
<p>Nagios is the de-facto standard, but it still abides by a dated &#8220;everything is a machine, and every machine
is persistent&#8221; paradigm. It doesn&#8217;t play well with a highly dynamic, virtualized, autoscaling world. The fork
that I&#8217;ve run lately, Icinga, makes some improvements on the original by providing database-backed configurations
and an <span class="caps">API</span>, but that&#8217;s still at best a bolt-on fix. The open source world has done great things with log
collection and analysis (Logstash) and metric collection and display (Graphite and the many related projects),
but these focus on getting the data, not acting on it. Some interesting solutions have come out of companies
such as NetFlix (&lt;&lt;<links>&gt;&gt;), but they&#8217;re not really easily-usable general-purpose&nbsp;solutions.</p>
<p>So, what should monitoring in the new world look&nbsp;like?</p>
<ul>
<li>Not everything is a machine. We care as much about services and APIs as we do about hosts (probably more).
So, first off, the Nagios paradigm of hosts and services is dated. Firstly, it needs a higher-level container,
such as an Application, that describes a &#8220;thing&#8221; running across multiple hosts, comprised of multiple services.
There are some hacks to get Nagios to work this way (check-multi, anyone?) but there needs to be a real, high-level
object that understands concepts such as load balancer pools. Also, not every &#8220;thing&#8221; we want to monitor is a
network&nbsp;host.</li>
<li>We now live in a highly dynamic world with autoscaling and service registries. Adding another host (whether it&#8217;s
a <span class="caps">VM</span> or an <span class="caps">EC2</span> instance or a container) of a given type should be a simple task in the monitoring&nbsp;tool.</li>
<li>Similarly, configuration needs to be more centralized. Nagios&#8217; check execution model is horribly archaic. There should
be some sort of agent running on monitored hosts that knows what&#8217;s running on the host and what checks are available. A
central tool should know how to monitor those things. I.e. the agent should report in and say, &#8220;Hi, I&#8217;m a production
(based on tags or some local configuration) web server running Apache for the FooBar application.&#8221; The central server
should then determine, &#8220;ok, run these checks with these intervals and tell me the&nbsp;results.&#8221;</li>
<li>Metric collection and monitoring should be unified. We want numeric data points not boolean values. Our alerting and
graphing systems should use the same&nbsp;data.</li>
<li>We should be able to query data out of existing data stores, whether it&#8217;s Graphite or an <span class="caps">API</span>. The big paradigm change
here is taking advantage of bulk queries. A query for state of <span class="caps">ALL</span> of our <span class="caps">EC2</span> instances should update the correct things.
Executing a command for every host or service check is&nbsp;bad.</li>
<li>Service discovery and host&nbsp;discovery.</li>
<li>Notifications. They should have multiple contact methods built-in, and something like PagerDuty. Additionally, end users
should be able to easily manage their own notifications (in addition to central&nbsp;management).</li>
<li>Default notifications shouldn&#8217;t be based on fixed thresholds, they should be based on rate of change over&nbsp;time.</li>
<li>Stop all this <span class="caps">SSH</span> nonsense. Either run a daemon specific to this and listening on its own port and <span class="caps">API</span>, or use a message
queue. Maybe just use MCollective for some of&nbsp;it.</li>
<li>Configuration should mostly be stored centrally. The only configuration on a client should be what <span class="caps">AM</span> I. The central
service should determine what to do/run and how&nbsp;often.</li>
<li>We can&#8217;t think of &#8220;nodes&#8221; as being able to run an arbitraty daemon. Sort of contrary to the above. We want a daemon
for machines that can run it, and for it to be part of the core project, not some bolt-on. But we need to be able to consider
things that can&#8217;t run our software - i.e. appliances with their own APIs - as the same first-class citizens that other
things&nbsp;are.</li>
<li>
<p>We need to be able to handle data that isn&#8217;t just numbers, let alone booleans. Ideally, direct integration with something
like LogStash. Also, what about application-level metrics? What about code introspection and traceback handling like&nbsp;NewRelic?</p>
</li>
<li>
<p>Or maybe what we need is just something that pulls all of this together? i.e. Ring of Power that binds (both configures and
pulls data out of) Logstash, NewRelic, Graphite, and some monitoring tool to provide a unified interface and experience and
notifications, as well as update these things&nbsp;dynamically.</p>
</li>
</ul>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jantman'; // required: replace example with your forum shortname
            var disqus_identifier = 'some-thoughts-on-modern-monitoring';
            var disqus_url = 'http://blog.jasonantman.com/2015/05/some-thoughts-on-modern-monitoring/';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">

                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Recent Posts</h4></li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2015/07/awslimitchecker-check-your-aws-usage-against-service-limits/">
                                AwsLimitChecker - Check Your <span class="caps">AWS</span> Usage Against Service&nbsp;Limits
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2015/06/visualization-of-when-im-working-on-personal-vs-work-projects/">
                                Visualization of when I&#8217;m working on personal vs work&nbsp;projects
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2015/05/local-s3-server-to-acceptance-test-netflix-ice-installation-in-isolation/">
                                Local S3 Server to Acceptance Test Netflix Ice Installation In&nbsp;Isolation
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2015/04/jira-to-trello-script/">
                                Jira to Trello&nbsp;Script
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://blog.jasonantman.com/2015/03/my-new-found-love-of-trello-and-a-helpful-greasemonkey-script/">
                                My New-found Love of Trello and a Helpful GreaseMonkey&nbsp;Script
                            </a>
                        </li>


                <li class="list-group-item"><a href="http://blog.jasonantman.com/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                <li class="list-group-item">
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/blog/index.html">
                                blog
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/monitoring/index.html">
                                monitoring
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/microsoft/index.html">
                                microsoft
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/php/index.html">
                                PHP
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/wordpress/index.html">
                                wordpress
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/sun/index.html">
                                sun
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/security/index.html">
                                security
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/puppet/index.html">
                                puppet
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/sysadmin/index.html">
                                sysadmin
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/linux/index.html">
                                linux
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/google/index.html">
                                google
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/android/index.html">
                                android
                            </a>
                        </span>
                        <span class="tag-1">
                            <a href="http://blog.jasonantman.com/tags/nagios/index.html">
                                Nagios
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/python/index.html">
                                python
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/dns/index.html">
                                dns
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/droid/index.html">
                                droid
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/rpm/index.html">
                                rpm
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/apache/index.html">
                                apache
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/syslog/index.html">
                                syslog
                            </a>
                        </span>
                        <span class="tag-2">
                            <a href="http://blog.jasonantman.com/tags/firefox/index.html">
                                firefox
                            </a>
                        </span>
                </li>
        </ul>
    </section>
    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item" style="padding: 10px 15px 0px 15px;"><h4><i class="icon-twitter
    icon-large"></i>Twitter <a href="https://twitter.com/j_antman"
    class="twitter-follow-button" data-show-count="false"
    data-dnt="true">Follow @j_antman</a></h4>
<script>!function(d,s,id){var
  js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document,
  'script', 'twitter-wjs');</script></li>
    </ul>
    <a class="twitter-timeline" data-dnt="true"
    href="https://twitter.com/j_antman"
    data-chrome="transparent noheader" data-widget-id="429640274453594113">Tweets by @j_antman</a>
    <script>!function(d,s,id){var
    js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </section>
    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item"><h4><i class="icon-github icon-large"></i>GitHub Repos</h4></li>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
            <a href="https://github.com/jantman">@jantman</a> on GitHub
    </ul>
        <script type="text/javascript">
            $(document).ready(function () {
                if (!window.jXHR) {
                    var jxhr = document.createElement('script');
                    jxhr.type = 'text/javascript';
                    jxhr.src = 'http://blog.jasonantman.com/theme/js/jXHR.js';
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(jxhr, s);
                }

                github.showRepos({
                    user: 'jantman',
                    count: 5,
                    skip_forks: false,
                    target: '#gh_repos'
                });
            });
        </script>
        <script src="http://blog.jasonantman.com/theme/js/github.js" type="text/javascript"></script>
    </section>
</aside>        </div>
    </div>
</div>
<footer>
    <div class="container">
        <hr>
        <p class="pull-right"><i class="icon-arrow-up"></i> <a href="#">Back to top</a></p>


        <p>&copy; 2015 Jason Antman &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a></p>
    </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.jasonantman.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.jasonantman.com/theme/js/respond.min.js"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jantman'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>


</body>
</html>