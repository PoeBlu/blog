<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Brother HL2170W DHCP Problems</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Brother HL2170W DHCP Problems"/>
            <meta property="og:url" content="http://jantman.github.io/blog/2009/04/brother-hl2170w-dhcp-problems/"/>
            <meta property="og:description" content="Two weeks ago, I wrote about the Brother HL-2170W that I got for my mother. It seemed absolutely wonderful. Until the night of March 31st, just before Conficker was supposed to strike. Being that mom’s computer is the only one at home running Windows, I finished up a ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://jantman.github.io/blog/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://jantman.github.io/blog/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://jantman.github.io/blog/theme/css/pygments.css" rel="stylesheet">
        <link href="http://jantman.github.io/blog/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://jantman.github.io/blog/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>


</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://jantman.github.io/blog" class="navbar-brand">Jason Antman's Blog</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://jantman.github.io/blog/pages/about.html">
                             About
                          </a></li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/ideas-and-rants.html">Ideas and rants</a>
                        </li>
                        <li class="active">
                            <a href="http://jantman.github.io/blog/category/miscellaneous.html">Miscellaneous</a>
                        </li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/monitoring.html">Monitoring</a>
                        </li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/projects.html">Projects</a>
                        </li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/puppet.html">Puppet</a>
                        </li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/sysadmin.html">Sysadmin</a>
                        </li>
                        <li >
                            <a href="http://jantman.github.io/blog/category/tech-howtos.html">Tech howtos</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://jantman.github.io/blog/archives.html"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://jantman.github.io/blog/2009/04/brother-hl2170w-dhcp-problems/"
                       rel="bookmark"
                       title="Permalink to Brother HL2170W DHCP Problems">
                        Brother <span class="caps">HL2170W</span> <span class="caps">DHCP</span>&nbsp;Problems
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Sat 11 April 2009
    </span>



<span class="label label-default">Tags</span>
	<a href="http://jantman.github.io/blog/tag/dhcp.html">dhcp</a>
        /
	<a href="http://jantman.github.io/blog/tag/hl2170w.html">hl2170w</a>
        /
	<a href="http://jantman.github.io/blog/tag/printer.html">printer</a>
        /
	<a href="http://jantman.github.io/blog/tag/vlan.html">vlan</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Two weeks ago, I <a href="/2009/03/brother-hl-2170w-great-features-from-a-personal-laser-printer/">wrote about the Brother
<span class="caps">HL</span>-2170W</a>
that I got for my mother. It seemed absolutely wonderful. Until the
night of March 31st, just before Conficker was supposed to strike. Being
that mom&#8217;s computer is the only one at home running Windows, I finished
up a long-standing project - and moved her desktop, printer, and AppleTV
over to a separate <span class="caps">VLAN</span> that&#8217;s not routable to anything else internal
(i.e. anything important, or anything of mine). I&#8217;d already had the
&#8220;client&#8221; <span class="caps">VLAN</span> setup for a while, so it was just a matter of tweaking the
firewall rules and moving the static <span class="caps">DHCP</span> assignments from one subnet to
the&nbsp;other.</p>
<p>Well, that&#8217;s where the problems started. While her Windows <span class="caps">XP</span> desktop
and AppleTV coped nicely, and got their new addresses in <span class="caps">DHCP</span> as they
should, the <span class="caps">HL2170W</span> did not, As a matter of fact, after two hours, I
hadn&#8217;t seen a single <span class="caps">DHCP</span> request, even though I had the lease time set
to 10 minutes for both subnets. So, I tried administratively downing the
switch port a few times, to no avail. After a day of waiting, I came
back to the problem - and <em>still</em> found nothing in the <span class="caps">DHCP</span> logs from
that printer. I emailed mom and asked her to power-cycle it a few
times&#8230; still nothing! It wasn&#8217;t even requesting <span class="caps">DHCP</span> when rolled, let
alone at a regular&nbsp;interval!</p>
<p>Fast forward a week or so, to today. I&#8217;m ready to call Brother Support,
as my mother hasn&#8217;t had use of her new printer in a week and a half. I&#8217;m
infuriated - I&#8217;ve rolled the printer dozens of times, and not a single
event in the <span class="caps">DHCP</span> log. I know it&#8217;s sending traffic from the port - I&#8217;ve
reset the counters and they&#8217;re changing. I tried moving it back to the
original <span class="caps">VLAN</span> and confirmed that it still has its&#8217; original <span class="caps">IP</span>. I could
get into the web interface via <a href="http://lynx.isc.org/">lynx</a> and *tell
it* to refresh <span class="caps">DHCP</span>, but this seemed quite pointless - there&#8217;s no way
it&#8217;s physically possible to send the web request and then switch the
port to the new <span class="caps">VLAN</span> before it gets&nbsp;<span class="caps">DHCP</span>.</p>
<p>So, I&#8217;m ready to call Brother Support. I then notice that the printer is
turned off at the moment. From the switch log, it looks as though it&#8217;s
been powered off for six days. So, I turn it on. And then go about
starting my prep for the Brother call, first opening up a tail on the
<span class="caps">DHCP</span> server log, grepped for the proper interface. And, wouldn&#8217;t you
know, as I get up to let the dog out, the printer starts spitting out&nbsp;pages!</p>
<p>As far as I can tell, there&#8217;s something <em>seriously wrong</em> with the
Brother <span class="caps">HL</span>-2170W <span class="caps">DHCP</span> implementation. Specifically, it didn&#8217;t get an
address on the new <span class="caps">VLAN</span> until it was powered off for a *long* time.
Even reboots wouldn&#8217;t trigger a request, until the box had been powered
off for <em>days</em>. More importantly, though, it seems that it only gets
<span class="caps">DHCP</span> <strong><em>once</em></strong> when it boots, and totally disregards the lease&nbsp;time!</p>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="#"><i
                            class="icon-You can add links in your config file-sign icon-large"></i>You can add links in your config file
                    </a></li>
                    <li class="list-group-item"><a href="#"><i
                            class="icon-Another social link-sign icon-large"></i>Another social link
                    </a></li>



                <li class="list-group-item"><a href="http://jantman.github.io/blog/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/linux.html">
                                linux
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/php.html">
                                PHP
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/android.html">
                                android
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/google.html">
                                google
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/nagios.html">
                                Nagios
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jantman.github.io/blog/tag/sysadmin.html">
                                sysadmin
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/logging.html">
                                logging
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/wordpress.html">
                                wordpress
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/apache.html">
                                apache
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/firefox.html">
                                firefox
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/blog.html">
                                blog
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/perl.html">
                                perl
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/monitoring.html">
                                monitoring
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/microsoft.html">
                                microsoft
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/dns.html">
                                dns
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/syslog.html">
                                syslog
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/bind.html">
                                bind
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/sun.html">
                                sun
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/mediawiki.html">
                                mediawiki
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/rpm.html">
                                rpm
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/droid.html">
                                droid
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/puppet.html">
                                puppet
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/ems.html">
                                EMS
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/security.html">
                                security
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jantman.github.io/blog/tag/mac.html">
                                mac
                            </a>
                        </li>
        </ul>
    </section>
</aside>        </div>
    </div>
</div>
<footer>
    <div class="container">
        <hr>
        <p class="pull-right"><i class="icon-arrow-up"></i> <a href="#">Back to top</a></p>


        <p>&copy; 2014 Jason Antman &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a></p>
    </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://jantman.github.io/blog/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://jantman.github.io/blog/theme/js/respond.min.js"></script>


</body>
</html>