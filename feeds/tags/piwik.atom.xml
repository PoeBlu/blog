<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Jason Antman's Blog</title><link href="http://blog.jasonantman.com/" rel="alternate"></link><link href="http://blog.jasonantman.com/feeds/tags/piwik.atom.xml" rel="self"></link><id>http://blog.jasonantman.com/</id><updated>2012-08-26T13:18:00-04:00</updated><entry><title>Piwik Web Analytics, and some unfortunate stats about my blog</title><link href="http://blog.jasonantman.com/2012/08/piwik-web-analytics-and-some-unfortunate-stats-about-my-blog/" rel="alternate"></link><updated>2012-08-26T13:18:00-04:00</updated><author><name>admin</name></author><id>tag:blog.jasonantman.com,2012-08-26:2012/08/piwik-web-analytics-and-some-unfortunate-stats-about-my-blog/</id><summary type="html">&lt;p&gt;Back in March when I selected a new template for this blog, I
&lt;a href="/2012/03/new-blog-theme/"&gt;posted&lt;/a&gt; that I was looking into open source
self-hosted web analytics tools to replace &lt;a href="http://www.google.com/analytics/"&gt;Google
Analytics&lt;/a&gt;. There were a few reasons
for this; most importantly, it started from a discussion with some
privacy-conscious coworkers, who said that they use
&lt;a href="http://noscript.net/"&gt;NoScript&lt;/a&gt; and specifically block Google from
tracking them (which also breaks Google Analytics). This was a serious
issue for me, as I no longer process server-side logs but relied solely
on Google Analytics for traffic information. So, I decided to try
something other than Google and ended up settling on
&lt;a href="http://piwik.org/"&gt;Piwik&lt;/a&gt; as my solution. I will say, in full
disclosure, that the amount of information Piwki gives is a bit scary; I
can watch users navigate this blog in realtime, and even the initial
dashboard page gives a list of the most recent visitors, with their &lt;span class="caps"&gt;IP&lt;/span&gt;
address, country of origin, browser, &lt;span class="caps"&gt;OS&lt;/span&gt;, and the pages they visited.
However my decision was made on two main points: first, that I wanted
something withich could use server-side &lt;span class="caps"&gt;PHP&lt;/span&gt; to log visits (albeit with a
lot less information) of people who had JavaScript or tracking disabled,
and second, that if &lt;em&gt;someone&lt;/em&gt; is going to have such amazingly detailed
information on my visitors, it should be me, so I can ensure that I&amp;#8217;m
the only person who has access to it and that it isn&amp;#8217;t used for the
wrong&amp;nbsp;purposes.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Aside: The only revenue I get from this site is through &lt;a href=""&gt;Google
AdSense&lt;/a&gt;, which isn&amp;#8217;t a whole lot given the low traffic (certainly
not enough to pay for the hosting). Other than that, I keep this blog
to try and share my knowledge with others, and hope that someone else
can find the solution to their problem here instead of doing the work
that I did. So, I find analytics very helpful; I check my stats now
and then, go back and update or add to the most popular posts, and try
to write relevant posts if it seems like a lot of people are finding
their way here for something slightly different than the actual post
they landed on. Unfortunately, that last point isn&amp;#8217;t as easy since
&lt;a href="http://googleblog.blogspot.com/2011/10/making-search-more-secure.html"&gt;Google switched to &lt;span class="caps"&gt;HTTPS&lt;/span&gt; Search for logged-in users on October 18th,
2011&lt;/a&gt;
- I can no longer use Piwik see the search keywords that got Google
users to my site. Luckily, these are still available through &lt;a href="https://www.google.com/webmasters/tools/"&gt;Google
Webmaster Tools&lt;/a&gt; (via
Traffic -&gt; Search Queries on the left menu), though it adds an
additional step and removes some of my motivation to check regularly
and make sure people are getting useful content. Also, perhaps most
importantly, it doesn&amp;#8217;t let me associate search query with other stats
like time on page, so even if one search query was very popular, I
have no way of knowing whether all those people actually read the
page, or took one look at it and&amp;nbsp;left.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I really like Piwki. I don&amp;#8217;t use most of it terribly often, but it gives
me a nice overview visits graph on the WordPress dashboard (via the
&lt;a href="http://wordpress.org/extend/plugins/wp-piwik/"&gt;&lt;span class="caps"&gt;WP&lt;/span&gt;-Piwik&lt;/a&gt; plugin),
infinitely detailed information (most of which I haven&amp;#8217;t even looked at)
in the Piwki web interface, and nightly email reports of visits to the
site. It also supports multiple sites, so I have it on my ancient
&lt;a href="http://wiki.jasonantman.com"&gt;wiki&lt;/a&gt;, my
&lt;a href="http://redmine.jasonantman.com"&gt;Redmine&lt;/a&gt; instance, and even
&lt;a href="/2012/03/adding-piwik-web-analytics-integration-to-viewvc/"&gt;ViewVC&lt;/a&gt;.
I&amp;#8217;d highly recommend it; it&amp;#8217;s full-featured (beyond anything I can even
comprehend,&amp;nbsp;really)&lt;/p&gt;
&lt;p&gt;I was recently looking through the stats for this blog, and came by some
unfortunate, though not surprising, trends. Below is the graph of visits
per day, from April 1, 2012 through today (August 26,&amp;nbsp;2012):&lt;/p&gt;
&lt;p&gt;&lt;img alt="blog visits chart" src="/GFX/blog_visits.png" /&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It&amp;#8217;s probably not terribly unusual for a site with as much technical
    content as mine (and mostly professional stuff, not just for
    hobbyists), my weekend traffic is usually a full 50% lower than
    weekday traffic. This can also be seen in the graph of visits by
    visitor&amp;#8217;s local time, which is decidedly biased towards the 9am-5pm
    window:&lt;br /&gt;
&lt;img alt="blog visits chart by visitor local
    time" src="/GFX/blog_visits_localtime.png" /&gt;&lt;br /&gt;
    I guess there&amp;#8217;s nothing I can really do about that, and it just
    gives me a nice maintenance window at 4am on Sunday mornings&amp;nbsp;:)&lt;/li&gt;
&lt;li&gt;Looking at the overall graph, there also appears to be quite a bit
    of oscillation of the average visits over time. It&amp;#8217;s nothing
    terribly large, but at a guess, I&amp;#8217;d attribute it to my sporadic&amp;nbsp;posting.&lt;/li&gt;
&lt;li&gt;Though it&amp;#8217;s not visible in these graphs, this site has an 80% bounce
    rate (the percent of visitors that viewed only one page and then
    left the site). I guess that&amp;#8217;s also not terribly unusual for a site
    with mostly how-to information on a wide variety of&amp;nbsp;topics.&lt;/li&gt;
&lt;li&gt;To add a little more information to some of the previous items, here
    is the chart of my &lt;a href="http://feedburner.google.com"&gt;Feedburner&lt;/a&gt;
    &lt;span class="caps"&gt;RSS&lt;/span&gt;/Atom feed, since I started using Feedburner in February. The
    number of subscribers is in green, and the reach (number of people
    who actually clicked through to a post) is in blue:&lt;br /&gt;
&lt;img alt="Feedburner stats" src="/GFX/feedburner_stats.png" /&gt;&lt;br /&gt;
    This is a clear indication of something even stronger than the
    &amp;#8220;bounce rate&amp;#8221;; the apparently high number of people who subscribe to
    and then unsubscribe from my feed (if these stats are accurate). To
    me, this is an even stronger indication that what I really need to
    do is post useful content on a more regular basis - I have a
    tendency to blog in spurts, and either start a draft and never
    finish it, or write a few posts and set them to &amp;#8220;pending&amp;#8221; status
    with the intent of publishing them over a few days&amp;#8230; and then
    forget the last&amp;nbsp;part.&lt;/li&gt;
&lt;/ol&gt;</summary><category term="blog"></category><category term="google analytics"></category><category term="piwik"></category></entry><entry><title>Adding Piwik Web Analytics Integration to ViewVC</title><link href="http://blog.jasonantman.com/2012/03/adding-piwik-web-analytics-integration-to-viewvc/" rel="alternate"></link><updated>2012-03-23T21:15:00-04:00</updated><author><name>admin</name></author><id>tag:blog.jasonantman.com,2012-03-23:2012/03/adding-piwik-web-analytics-integration-to-viewvc/</id><summary type="html">&lt;p&gt;&lt;strong&gt;Update February 2014:&lt;/strong&gt; Give up the analytics, and just host your code
on &lt;a href="https://github.com"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;All of my public &lt;a href="http://viewvc.jasonantman.com"&gt;subversion
repositories&lt;/a&gt; and &lt;a href="http://cvs.jasonantman.com"&gt;&lt;span class="caps"&gt;CVS&lt;/span&gt;
repositories&lt;/a&gt; are available online through a
great Python application called &lt;a href="http://viewvc.org/"&gt;ViewVC&lt;/a&gt;, which
provides a web-based interface to &lt;span class="caps"&gt;CVS&lt;/span&gt; and &lt;span class="caps"&gt;SVN&lt;/span&gt; repositories, as well as
history browsing, graphical diffs, etc. An amazingly large amount of the
traffic to my web server is for the vhosts that serve this, so I decided
that I should add some analytics to it. I&amp;#8217;m in the process of trying out
&lt;a href="http://piwik.org"&gt;Piwik&lt;/a&gt;, a full-featured, &lt;span class="caps"&gt;GPL&lt;/span&gt;-licensed, self-hosted
alternative to &lt;a href="http://www.google.com/analytics/"&gt;Google Analytics&lt;/a&gt;. It
gives lots of useful information like number of visits and unique visits
per page, search engine keywords, referrers, average time on page,
bounce rate (number of one-page visits),&amp;nbsp;etc.&lt;/p&gt;
&lt;p&gt;I have ViewVC installed from the &lt;a href="http://pkgs.repoforge.org/viewvc/"&gt;RPMforge
packages&lt;/a&gt;, so there&amp;#8217;s one code base
for both of my vhosts. This means that I can&amp;#8217;t simply slap the tracking
code at the bottom of the templates and call it a day. I opted to go for
a nicer solution, and what follows is a patch (diff -u) to the current
(1.1.13) version of ViewVC that adds a &amp;#8220;piwik&amp;#8221; section to viewvc.conf,
and adds the piwik tracking code with the specified base &lt;span class="caps"&gt;URL&lt;/span&gt; and site &lt;span class="caps"&gt;ID&lt;/span&gt;
into all ViewVC pages.&amp;nbsp;Enjoy.&lt;/p&gt;
&lt;div class="codehilite"&gt;&lt;pre&gt;&lt;span class="gh"&gt;diff -ru viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/lib/config.py viewvc/lib/config.py&lt;/span&gt;
&lt;span class="gd"&gt;--- viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/lib/config.py   2012-01-25 08:31:52.000000000 -0500&lt;/span&gt;
&lt;span class="gi"&gt;+++ viewvc/lib/config.py    2012-03-23 21:57:08.000000000 -0400&lt;/span&gt;
&lt;span class="gu"&gt;@@ -108,6 +108,7 @@&lt;/span&gt;
     &amp;#39;query&amp;#39;,
     &amp;#39;templates&amp;#39;,
     &amp;#39;utilities&amp;#39;,
&lt;span class="gi"&gt;+    &amp;#39;piwik&amp;#39;,&lt;/span&gt;
     )
   _force_multi_value = (
     # Configuration values with multiple, comma-separated values.
&lt;span class="gu"&gt;@@ -127,6 +128,7 @@&lt;/span&gt;
                &amp;#39;options&amp;#39;,
                &amp;#39;templates&amp;#39;,
                &amp;#39;utilities&amp;#39;,
&lt;span class="gi"&gt;+               &amp;#39;piwik&amp;#39;,&lt;/span&gt;
                ),
     &amp;#39;root&amp;#39;  : (&amp;#39;authz-*&amp;#39;,
                &amp;#39;options&amp;#39;,
&lt;span class="gu"&gt;@@ -461,7 +463,14 @@&lt;/span&gt;
     self.cvsdb.check_database_for_root = 0

     self.query.viewvc_base_url = None
&lt;span class="gd"&gt;-    &lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+    # begin  patch for piwik integration&lt;/span&gt;
&lt;span class="gi"&gt;+    self.piwik.use_piwik = 0&lt;/span&gt;
&lt;span class="gi"&gt;+    self.piwik.base_url = &amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="gi"&gt;+    self.piwik.site_id = &amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="gi"&gt;+    self.piwik.use_jsindex = 0&lt;/span&gt;
&lt;span class="gi"&gt;+    # end  patch for piwik integration&lt;/span&gt;
&lt;span class="gi"&gt;+   &lt;/span&gt;
 def _startswith(somestr, substr):
   return somestr[:len(substr)] == substr

&lt;span class="gh"&gt;diff -ru viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/templates/include/footer.ezt viewvc/templates/include/footer.ezt&lt;/span&gt;
&lt;span class="gd"&gt;--- viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/templates/include/footer.ezt    2012-01-25 08:31:52.000000000 -0500&lt;/span&gt;
&lt;span class="gi"&gt;+++ viewvc/templates/include/footer.ezt 2012-03-23 22:03:04.000000000 -0400&lt;/span&gt;
&lt;span class="gu"&gt;@@ -13,5 +13,17 @@&lt;/span&gt;



&lt;span class="gi"&gt;+[is cfg.piwik.use_piwik &amp;quot;1&amp;quot;]&lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+var pkBaseURL = ((&amp;quot;https:&amp;quot; == document.location.protocol) ? &amp;quot;https://[cfg.piwik.base_url]/&amp;quot; : &amp;quot;http://[cfg.piwik.base_url]/&amp;quot;);&lt;/span&gt;
&lt;span class="gi"&gt;+document.write(unescape(&amp;quot;%3Cscript src=&amp;#39;&amp;quot; + pkBaseURL + &amp;quot;[is cfg.piwik.use_jsindex &amp;quot;1&amp;quot;]js/[else]piwik.js[end]&amp;#39; type=&amp;#39;text/javascript&amp;#39;%3E%3C/script%3E&amp;quot;));&lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+try {&lt;/span&gt;
&lt;span class="gi"&gt;+var piwikTracker = Piwik.getTracker(pkBaseURL + &amp;quot;piwik.php&amp;quot;, [cfg.piwik.site_id]);&lt;/span&gt;
&lt;span class="gi"&gt;+piwikTracker.trackPageView();&lt;/span&gt;
&lt;span class="gi"&gt;+piwikTracker.enableLinkTracking();&lt;/span&gt;
&lt;span class="gi"&gt;+} catch( err ) {}&lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+[else][end]&lt;/span&gt;


Only in viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/templates/include: header.ezt~
&lt;span class="gh"&gt;diff -ru viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/viewvc.conf.dist viewvc/viewvc.conf.dist&lt;/span&gt;
&lt;span class="gd"&gt;--- viewvc-&lt;span class="caps"&gt;ORIG&lt;/span&gt;/viewvc.conf.dist    2012-01-25 08:31:52.000000000 -0500&lt;/span&gt;
&lt;span class="gi"&gt;+++ viewvc/viewvc.conf.dist 2012-03-23 21:44:02.000000000 -0400&lt;/span&gt;
&lt;span class="gu"&gt;@@ -1131,3 +1131,29 @@&lt;/span&gt;
 #viewvc_base_url =

 ##---------------------------------------------------------------------------
&lt;span class="gi"&gt;+[piwik]&lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+## This section enables Piwik  web analytics tracking.&lt;/span&gt;
&lt;span class="gi"&gt;+## If piwik is enabled (use_piwik = 1) all other options must be specified.&lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+## This is based on a patch by Jason Antman  &lt;/span&gt;
&lt;span class="gi"&gt;+## to ViewVC 1.1.13, written 2012-03-23.&lt;/span&gt;
&lt;span class="gi"&gt;+## The latest version of the patch, and information on it, can always be found at:&lt;/span&gt;
&lt;span class="gi"&gt;+## &lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+## To enable piwik, change use_piwik to 1. Set to 0 to disable&lt;/span&gt;
&lt;span class="gi"&gt;+use_piwik = 1&lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+## Set base_url to the hostname and path to your piwik installation, with no trailing slash.&lt;/span&gt;
&lt;span class="gi"&gt;+## i.e. piwik.example.com or www.example.com/piwik&lt;/span&gt;
&lt;span class="gi"&gt;+base_url = piwik.example.com&lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+## Set to the numeric id of your website in Piwik&lt;/span&gt;
&lt;span class="gi"&gt;+site_id = 5&lt;/span&gt;
&lt;span class="gi"&gt;+##&lt;/span&gt;
&lt;span class="gi"&gt;+## Set to 1 if you want to use js/index.php to serve the tracking code, &lt;/span&gt;
&lt;span class="gi"&gt;+## or leave at 0 if you want to call piwik.js directly&lt;/span&gt;
&lt;span class="gi"&gt;+use_jsindex = 0&lt;/span&gt;
&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;span class="gi"&gt;+##---------------------------------------------------------------------------&lt;/span&gt;
\ No newline at end of file
&lt;/pre&gt;&lt;/div&gt;</summary><category term="analytics"></category><category term="piwik"></category><category term="python"></category><category term="subversion"></category><category term="svn"></category><category term="tracking"></category><category term="viewvc"></category></entry></feed>